# æ•°æ®æ•´åˆå¹³å° - é¡¹ç›®è¯´æ˜æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**æ•°æ®æ•´åˆå¹³å°**æ˜¯ä¸€ä¸ªä¼ä¸šçº§çš„å‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼Œç”¨äºæ•´åˆ11ä¸ªå¤–éƒ¨å……ç”µå¹³å°çš„æ•°æ®ï¼Œæä¾›ç»Ÿä¸€çš„æ•°æ®ç®¡ç†ã€å¤„ç†å’Œç»“ç®—åŠŸèƒ½ã€‚

- **è§£å†³çš„é—®é¢˜**ï¼šå¤šå¹³å°æ•°æ®æ ¼å¼ä¸ç»Ÿä¸€ï¼Œæ‰‹å·¥å¤„ç†æ•ˆç‡ä½
- **ç›®æ ‡ç”¨æˆ·**ï¼šä¼ä¸šæ•°æ®ç®¡ç†äººå‘˜ã€è´¢åŠ¡ç»“ç®—äººå‘˜
- **æ ¸å¿ƒä»·å€¼**ï¼šè‡ªåŠ¨åŒ–æ•°æ®å¤„ç†ï¼Œæé«˜ç»“ç®—å‡†ç¡®æ€§

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

### æ•´ä½“æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯åº”ç”¨   â”‚â”€â”€â”€â”€â–¶â”‚   APIç½‘å…³    â”‚â”€â”€â”€â”€â–¶â”‚   æ•°æ®åº“    â”‚
â”‚  Vue 3 + TS â”‚     â”‚  Flask API  â”‚     â”‚  Supabase   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç›®å½•ç»“æ„
```
D:\Desktop\manager\
â”œâ”€â”€ frontend/              # Vue 3 å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/              
â”‚   â”‚   â”œâ”€â”€ assets/       # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ components/   # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ router/       # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ stores/       # PiniaçŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ utils/        # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ views/        # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ package.json      # å‰ç«¯ä¾èµ–
â”‚   â””â”€â”€ vite.config.ts    # Viteé…ç½®
â”‚
â”œâ”€â”€ api/                   # Verceléƒ¨ç½²çš„APIæœåŠ¡
â”‚   â”œâ”€â”€ index.py          # Flask APIå…¥å£
â”‚   â””â”€â”€ requirements.txt  # Pythonä¾èµ–
â”‚
â”œâ”€â”€ backend/              # æœ¬åœ°å¼€å‘åç«¯ï¼ˆSQLiteç‰ˆï¼‰
â”‚   â”œâ”€â”€ app.py           # Flaskåº”ç”¨
â”‚   â””â”€â”€ instance/        # SQLiteæ•°æ®åº“
â”‚
â”œâ”€â”€ supabase/            # æ•°æ®åº“é…ç½®
â”‚   â””â”€â”€ migrations/      # æ•°æ®åº“è¿ç§»è„šæœ¬
â”‚       â””â”€â”€ 001_initial_schema.sql
â”‚
â”œâ”€â”€ .trae/               # é¡¹ç›®æ–‡æ¡£
â”‚   â””â”€â”€ documents/       
â”‚       â”œâ”€â”€ æ•°æ®æ•´åˆå¹³å°-äº§å“éœ€æ±‚æ–‡æ¡£.md
â”‚       â””â”€â”€ æ•°æ®æ•´åˆå¹³å°-æŠ€æœ¯æ¶æ„æ–‡æ¡£.md
â”‚
â”œâ”€â”€ vercel.json          # Verceléƒ¨ç½²é…ç½®
â”œâ”€â”€ .env.example         # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â””â”€â”€ requirements.txt     # æ ¹ç›®å½•Pythonä¾èµ–
```

## ğŸ›  æŠ€æœ¯æ ˆ

### å‰ç«¯æŠ€æœ¯
- **æ¡†æ¶**: Vue 3.5 + TypeScript 5.8
- **UIç»„ä»¶**: Element Plus 2.10
- **çŠ¶æ€ç®¡ç†**: Pinia 3.0
- **è·¯ç”±**: Vue Router 4.5
- **HTTPå®¢æˆ·ç«¯**: Axios 1.11
- **æ„å»ºå·¥å…·**: Vite 7.0
- **ä»£ç è§„èŒƒ**: ESLint + Prettier

### åç«¯æŠ€æœ¯
- **æ¡†æ¶**: Flask 2.3
- **æ•°æ®åº“**: Supabase (PostgreSQL)
- **ORM**: SQLAlchemy 2.0
- **è®¤è¯**: JWT (PyJWT)
- **å¯†ç åŠ å¯†**: Werkzeug Security
- **è·¨åŸŸ**: Flask-CORS
- **éƒ¨ç½²**: Vercel Functions

### æ•°æ®åº“
- **ç”Ÿäº§ç¯å¢ƒ**: Supabase PostgreSQL
- **å¼€å‘ç¯å¢ƒ**: SQLite
- **æ•°æ®å¤„ç†**: Pandas + OpenPyXL

## ğŸ’¼ åŠŸèƒ½æ¨¡å—

### ç”¨æˆ·è§’è‰²
| è§’è‰² | æƒé™ | è¯´æ˜ |
|------|------|------|
| ç®¡ç†å‘˜ | å…¨éƒ¨æƒé™ | ç³»ç»Ÿé…ç½®ã€ç”¨æˆ·ç®¡ç† |
| æ•°æ®æ“ä½œå‘˜ | æ•°æ®ç®¡ç† | æ•°æ®å¯¼å…¥ã€æŸ¥è¯¢ã€ä¿®æ”¹ |
| è´¢åŠ¡äººå‘˜ | è´¢åŠ¡åŠŸèƒ½ | å¯¹è´¦ã€ç»“ç®—ã€è´¦å•å¯¼å‡º |

### æ ¸å¿ƒåŠŸèƒ½
1. **ç”¨æˆ·è®¤è¯** - JWTä»¤ç‰Œè®¤è¯ï¼Œè§’è‰²æƒé™ç®¡ç†
2. **è½¦é˜Ÿç®¡ç†** - è½¦é˜Ÿä¿¡æ¯ç»´æŠ¤ï¼Œè®¡ä»·è§„åˆ™é…ç½®
3. **è½¦è¾†ç®¡ç†** - è½¦è¾†ä¿¡æ¯ç®¡ç†ï¼Œå¸æœºä¿¡æ¯ç»´æŠ¤
4. **ç«™ç‚¹ç®¡ç†** - å……ç”µç«™ç‚¹ä¿¡æ¯ç®¡ç†
5. **è®¢å•ç®¡ç†** - 11ä¸ªå¹³å°è®¢å•æ•°æ®æ•´åˆ
6. **å……å€¼ç®¡ç†** - å……å€¼è®°å½•å¯¼å…¥ä¸æŸ¥è¯¢
7. **æ•°æ®å¯¼å…¥** - å¤šå¹³å°æ•°æ®è‡ªåŠ¨åŒ–å¯¼å…¥
8. **æ•°æ®å¯¼å‡º** - æ¡ä»¶æŸ¥è¯¢ä¸æ‰¹é‡å¯¼å‡º
9. **å¯¹è´¦ä¸­å¿ƒ** - æœˆåº¦ç»“ç®—ï¼Œä½™é¢ç®¡ç†
10. **ç³»ç»Ÿè®¾ç½®** - ç”¨æˆ·ç®¡ç†ï¼Œç³»ç»Ÿé…ç½®

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 20.19.0
- Python >= 3.8
- MySQL 8.0 æˆ– PostgreSQL

### å‰ç«¯å¯åŠ¨

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd frontend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# è®¿é—® http://localhost:5173
```

### åç«¯å¯åŠ¨

#### æ–¹å¼1ï¼šä½¿ç”¨Vercel APIï¼ˆæ¨èï¼‰

```bash
# è¿›å…¥APIç›®å½•
cd api

# åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
cp ../.env.example .env

# ç¼–è¾‘.envæ–‡ä»¶ï¼Œé…ç½®ä»¥ä¸‹å˜é‡ï¼š
# SUPABASE_URL=ä½ çš„Supabaseé¡¹ç›®URL
# SUPABASE_ANON_KEY=ä½ çš„SupabaseåŒ¿åå¯†é’¥
# SUPABASE_SERVICE_KEY=ä½ çš„SupabaseæœåŠ¡å¯†é’¥
# SECRET_KEY=ä½ çš„Flaskå¯†é’¥
# JWT_SECRET_KEY=ä½ çš„JWTå¯†é’¥

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# è¿è¡ŒAPIæœåŠ¡
python index.py
```

#### æ–¹å¼2ï¼šä½¿ç”¨æœ¬åœ°SQLiteç‰ˆæœ¬

```bash
# è¿›å…¥backendç›®å½•
cd backend

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# è¿è¡Œåº”ç”¨
python app.py

# APIæœåŠ¡è¿è¡Œåœ¨ http://localhost:5000
```

### æ•°æ®åº“åˆå§‹åŒ–

å¦‚æœä½¿ç”¨Supabaseï¼š
1. åˆ›å»ºSupabaseé¡¹ç›®
2. åœ¨SQLç¼–è¾‘å™¨ä¸­æ‰§è¡Œ `supabase/migrations/001_initial_schema.sql`
3. é…ç½®ç¯å¢ƒå˜é‡

å¦‚æœä½¿ç”¨æœ¬åœ°æ•°æ®åº“ï¼š
- SQLiteä¼šè‡ªåŠ¨åˆ›å»º
- é»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼šadmin/admin123

## ğŸ“ APIæ–‡æ¡£

### è®¤è¯æ¥å£

#### ç™»å½•
```http
POST /api/auth/login
Content-Type: application/json

{
  "username": "admin",
  "password": "admin123"
}
```

#### æ³¨å†Œ
```http
POST /api/auth/register
Content-Type: application/json

{
  "username": "newuser",
  "email": "user@example.com",
  "password": "password123",
  "role": "operator"
}
```

### æ•°æ®ç®¡ç†æ¥å£

#### è·å–è½¦è¾†åˆ—è¡¨
```http
GET /api/vehicles?page=1&per_page=20
Authorization: Bearer {token}
```

#### å¯¼å…¥è®¢å•æ•°æ®
```http
POST /api/orders/import
Authorization: Bearer {token}
Content-Type: multipart/form-data

platform_id: 1
file: [Excelæ–‡ä»¶]
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
# Supabaseé…ç½®
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_KEY=your-service-key

# åº”ç”¨é…ç½®
SECRET_KEY=your-secret-key-here
JWT_SECRET_KEY=jwt-secret-string

# æ•°æ®åº“é…ç½®ï¼ˆæœ¬åœ°å¼€å‘ï¼‰
DATABASE_URL=sqlite:///data_platform.db
```

### Verceléƒ¨ç½²é…ç½®

`vercel.json` å·²é…ç½®å¥½ï¼š
- å‰ç«¯è‡ªåŠ¨æ„å»ºéƒ¨ç½²
- APIå‡½æ•°è‡ªåŠ¨éƒ¨ç½²
- ç¯å¢ƒå˜é‡è‡ªåŠ¨æ³¨å…¥

## ğŸ“Š æ•°æ®æ¨¡å‹

### æ ¸å¿ƒæ•°æ®è¡¨

1. **users** - ç”¨æˆ·è¡¨
2. **fleets** - è½¦é˜Ÿè¡¨
3. **vehicles** - è½¦è¾†è¡¨
4. **stations** - ç«™ç‚¹è¡¨
5. **orders** - è®¢å•è¡¨
6. **platform_raw_data** - å¹³å°åŸå§‹æ•°æ®
7. **recharge_records** - å……å€¼è®°å½•
8. **fleet_balance** - è½¦é˜Ÿä½™é¢
9. **pricing_rules** - è®¡ä»·è§„åˆ™
10. **discount_rules** - ä¼˜æƒ è§„åˆ™

## ğŸ” å®‰å…¨æ³¨æ„äº‹é¡¹

âš ï¸ **é‡è¦æé†’**ï¼š
1. é¡¹ç›®ä¸­çš„APIå¯†é’¥éœ€è¦æ›´æ¢ä¸ºæ‚¨è‡ªå·±çš„
2. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰å¿…é¡»ä¿®æ”¹æ‰€æœ‰é»˜è®¤å¯†ç 
3. å»ºè®®å¯ç”¨HTTPS
4. å®šæœŸå¤‡ä»½æ•°æ®åº“

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å‰ç«¯ä¼˜åŒ–**
   - ä½¿ç”¨è·¯ç”±æ‡’åŠ è½½
   - ç»„ä»¶æŒ‰éœ€å¼•å…¥
   - å›¾ç‰‡æ‡’åŠ è½½

2. **åç«¯ä¼˜åŒ–**
   - ä½¿ç”¨Redisç¼“å­˜
   - æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
   - æ‰¹é‡æ“ä½œä¼˜åŒ–

3. **éƒ¨ç½²ä¼˜åŒ–**
   - ä½¿ç”¨CDNåŠ é€Ÿ
   - å¯ç”¨Gzipå‹ç¼©
   - æ•°æ®åº“è¿æ¥æ± 

## ğŸ¤ å¼€å‘å›¢é˜Ÿ

- äº§å“è®¾è®¡ï¼šäº§å“å›¢é˜Ÿ
- å‰ç«¯å¼€å‘ï¼šå‰ç«¯å›¢é˜Ÿ
- åç«¯å¼€å‘ï¼šåç«¯å›¢é˜Ÿ
- æµ‹è¯•æ”¯æŒï¼šQAå›¢é˜Ÿ

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä¸ºä¼ä¸šå†…éƒ¨é¡¹ç›®ï¼Œæœªç»æˆæƒç¦æ­¢å¤–éƒ¨ä½¿ç”¨ã€‚

## ğŸ“ è”ç³»æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»æŠ€æœ¯æ”¯æŒå›¢é˜Ÿã€‚

---

*æœ€åæ›´æ–°ï¼š2025å¹´1æœˆ6æ—¥*
